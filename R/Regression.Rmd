---
title: "quantreg"
author: "康欣来"
date: '2023-02-09'
output: html_document
---

```{r}
library(quantreg)
library(mgcv)
source('CM.R')
source('CRM.R')
source('CCRM.R')
source('HF1.R')
source('IntervalPlot.R')
source('DataGeneration.R')
```


```{r}
mydata = data_generation(10, 3, c(20,20,20), c(40,40,40), c(0,0,0), c(1,1,1), -20, 20, c(0,0,0), c(0.05,0.05,0.05), 10, 20, 0)
CCRM(cbind(yl, yu) ~ xl[,1] + xu[,1] + xl[,2] + xu[,2] + xl[,3] + xu[,3], data = mydata)
```

```{r include=FALSE}
t.CM = c()
t.CRM = c()
t.CCRM = c()
t.HF1 = c()
for(i in 1:100)
{
    mydata = data_generation(1000, 3, c(20,20,20), c(40,40,40), c(0,0,0), c(1,1,1), -20, 20, c(0,0,0), c(0.05,0.05,0.05), 10, 20, i)
    t1 = Sys.time()
    cm = CM(cbind(yl, yu) ~ xl[,1] + xu[,1] + xl[,2] + xu[,2] + xl[,3] + xu[,3], data = mydata)
    t2 = Sys.time()
    t.CM = c(t.CM, t2-t1)
    
    t3 = Sys.time()
    cm = CRM(cbind(yl, yu) ~ xl[,1] + xu[,1] + xl[,2] + xu[,2] + xl[,3] + xu[,3], data = mydata)
    t4 = Sys.time()
    t.CRM = c(t.CRM, t4-t3)
    
    t5 = Sys.time()
    cm = CCRM(cbind(yl, yu) ~ xl[,1] + xu[,1] + xl[,2] + xu[,2] + xl[,3] + xu[,3], data = mydata)
    t6 = Sys.time()
    t.CCRM = c(t.CCRM, t6-t5)
    
    t7 = Sys.time()
    cm = HF1(cbind(yl, yu) ~ xl[,1] + xu[,1] + xl[,2] + xu[,2] + xl[,3] + xu[,3], data = mydata)
    t8 = Sys.time()
    t.HF1 = c(t.HF1, t8-t7)
}
```

```{r}
summary(t.CM)
summary(t.CRM)
summary(t.CCRM)
summary(t.HF1)
```

```{r}
xl = c(1,2,3,4,5)
xu = c(2,4,6,8,10)
y = c(2,3,5,7,10)
HF1_sub(x,y)
```