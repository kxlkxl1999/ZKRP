#         for(t in 1:niter)
#         {
#             pb$tick()
#             data = data.frame(data_generation_outlier2(n, a, b, c, d, e, f, g, h, i, j, seed=t, outlierType="central and range", alpha=rate[r]))
#             hh[[t]] = comparasion(cbind(yl,yu)~xl+xu, data[,5:8])
#         }
#         hhh = myprocess(hh)
#
#         data_2c_m[r,] = hhh[[1]][1,]
#         data_2r_m[r,] = hhh[[1]][2,]
#         data_2l_m[r,] = hhh[[1]][3,]
#         data_2u_m[r,] = hhh[[1]][4,]
#
#         data_2c_l[r,] = hhh[[2]][1,]
#         data_2r_l[r,] = hhh[[2]][2,]
#         data_2l_l[r,] = hhh[[2]][3,]
#         data_2u_l[r,] = hhh[[2]][4,]
#
#         data_2c_u[r,] = hhh[[3]][1,]
#         data_2r_u[r,] = hhh[[3]][2,]
#         data_2l_u[r,] = hhh[[3]][3,]
#         data_2u_u[r,] = hhh[[3]][4,]
#     }
#
#     write.csv(data_2c_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2c_m.csv", row.names = FALSE)
#     write.csv(data_2r_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2r_m.csv", row.names = FALSE)
#     write.csv(data_2l_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2l_m.csv", row.names = FALSE)
#     write.csv(data_2u_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2u_m.csv", row.names = FALSE)
#
#     write.csv(data_2c_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2c_l.csv", row.names = FALSE)
#     write.csv(data_2r_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2r_l.csv", row.names = FALSE)
#     write.csv(data_2l_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2l_l.csv", row.names = FALSE)
#     write.csv(data_2u_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2u_l.csv", row.names = FALSE)
#
#     write.csv(data_2c_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2c_u.csv", row.names = FALSE)
#     write.csv(data_2r_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2r_u.csv", row.names = FALSE)
#     write.csv(data_2l_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2l_u.csv", row.names = FALSE)
#     write.csv(data_2u_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2u_u.csv", row.names = FALSE)
### Outlier type 3 =======================
print("outliertype 3:")
data_3c_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3c_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3r_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3r_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3l_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3l_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3u_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3u_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3c_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3c_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3r_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3r_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3l_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3l_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3u_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3u_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3c_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3c_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3r_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3r_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3l_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3l_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3u_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3u_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
for(r in 1:length(rate))
{
hh = list()
pb <- progress_bar$new(
format = '[:bar] :percent eta: :eta',
total = niter, clear = FALSE, width = 80
)
for(t in 1:niter)
{
pb$tick()
data = data.frame(data_generation_outlier3(n, a, b, c, d, e, f, g, h, i, j, seed=t, outlierType="central", alpha=rate[r]))
hh[[t]] = comparasion(cbind(yl,yu)~xl+xu, data[,5:8])
}
hhh = myprocess(hh)
data_3c_m[r,] = hhh[[1]][1,]
data_3r_m[r,] = hhh[[1]][2,]
data_3l_m[r,] = hhh[[1]][3,]
data_3u_m[r,] = hhh[[1]][4,]
data_3c_l[r,] = hhh[[2]][1,]
data_3r_l[r,] = hhh[[2]][2,]
data_3l_l[r,] = hhh[[2]][3,]
data_3u_l[r,] = hhh[[2]][4,]
data_3c_u[r,] = hhh[[3]][1,]
data_3r_u[r,] = hhh[[3]][2,]
data_3l_u[r,] = hhh[[3]][3,]
data_3u_u[r,] = hhh[[3]][4,]
}
write.csv(data_3c_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3c_m.csv", row.names = FALSE)
write.csv(data_3r_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3r_m.csv", row.names = FALSE)
write.csv(data_3l_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3l_m.csv", row.names = FALSE)
write.csv(data_3u_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3u_m.csv", row.names = FALSE)
write.csv(data_3c_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3c_l.csv", row.names = FALSE)
write.csv(data_3r_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3r_l.csv", row.names = FALSE)
write.csv(data_3l_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3l_l.csv", row.names = FALSE)
write.csv(data_3u_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3u_l.csv", row.names = FALSE)
write.csv(data_3c_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3c_u.csv", row.names = FALSE)
write.csv(data_3r_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3r_u.csv", row.names = FALSE)
write.csv(data_3l_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3l_u.csv", row.names = FALSE)
write.csv(data_3u_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3u_u.csv", row.names = FALSE)
### Outlier type 4 ==========================
print("outliertype 4:")
data_4c_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4c_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4r_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4r_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4l_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4l_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4u_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4u_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4c_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4c_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4r_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4r_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4l_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4l_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4u_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4u_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4c_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4c_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4r_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4r_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4l_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4l_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4u_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4u_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
for(r in 1:length(rate))
{
hh = list()
pb <- progress_bar$new(
format = '[:bar] :percent eta: :eta',
total = niter, clear = FALSE, width = 80
)
for(t in 1:niter)
{
pb$tick()
data = data.frame(data_generation_outlier4(n, a, b, c, d, e, f, g, h, i, j, seed=t, outlierType="central and range", alpha=rate[r]))
hh[[t]] = comparasion(cbind(yl,yu)~xl+xu, data[,5:8])
}
hhh = myprocess(hh)
data_4c_m[r,] = hhh[[1]][1,]
data_4r_m[r,] = hhh[[1]][2,]
data_4l_m[r,] = hhh[[1]][3,]
data_4u_m[r,] = hhh[[1]][4,]
data_4c_l[r,] = hhh[[2]][1,]
data_4r_l[r,] = hhh[[2]][2,]
data_4l_l[r,] = hhh[[2]][3,]
data_4u_l[r,] = hhh[[2]][4,]
data_4c_u[r,] = hhh[[3]][1,]
data_4r_u[r,] = hhh[[3]][2,]
data_4l_u[r,] = hhh[[3]][3,]
data_4u_u[r,] = hhh[[3]][4,]
}
write.csv(data_4c_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4c_m.csv", row.names = FALSE)
write.csv(data_4r_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4r_m.csv", row.names = FALSE)
write.csv(data_4l_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4l_m.csv", row.names = FALSE)
write.csv(data_4u_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4u_m.csv", row.names = FALSE)
write.csv(data_4c_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4c_l.csv", row.names = FALSE)
write.csv(data_4r_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4r_l.csv", row.names = FALSE)
write.csv(data_4l_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4l_l.csv", row.names = FALSE)
write.csv(data_4u_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4u_l.csv", row.names = FALSE)
write.csv(data_4c_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4c_u.csv", row.names = FALSE)
write.csv(data_4r_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4r_u.csv", row.names = FALSE)
write.csv(data_4l_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4l_u.csv", row.names = FALSE)
write.csv(data_4u_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4u_u.csv", row.names = FALSE)
}
simu_plotdata_save(rate = seq(0.01,0.5,0.08), n=200, 0, 20, 0, 1, 0, 10, 0.2, 0.5, 0, 5, seed = 0, niter = 500)
seq(0.01,0.5,0.08)
seq(0.01,0.25,0.08)
seq(0.01,0.25,0.05)
seq(0.01,0.25,0.04)
library(progress)
library(mgcv)
library(caret)
library(MAINT.Data)
library(iRegression)
library(MASS)
library(quantreg)
library(Rdonlp2)
library(sm)
library(Matrix)
source('IntervalPlot.R')
source('DataGeneration.R')
source("regression.R")
library(progress)
library(mgcv)
library(caret)
library(MAINT.Data)
library(iRegression)
library(MASS)
library(quantreg)
library(Rdonlp2)
library(sm)
library(Matrix)
source('IntervalPlot.R')
source('DataGeneration.R')
source("regression.R")
# 存48个数据文件(rmse(4) X outlierType(4) X 3)
myprocess <- function(list_of_mat)
{
n = length(list_of_mat)
nr = nrow(list_of_mat[[1]])
nc = ncol(list_of_mat[[1]])
m = matrix(0,nrow=nr, ncol=nc)
l95 = matrix(0,nrow=nr, ncol=nc)
u95 = matrix(0,nrow=nr, ncol=nc)
for(i in 1:nr)
{
for(j in 1:nc)
{
ele = c()
for(s in 1:n)
{
ele = c(ele, list_of_mat[[s]][i,j])
}
m[i,j] = mean(ele)
l95[i,j] = as.numeric(quantile(ele, 0.025))
u95[i,j] = as.numeric(quantile(ele, 0.975))
}
}
return(list(m,l95,u95))
}
simu_plotdata_save <- function(rate, n, a, b, c, d, e, f, g, h, i, j, seed, niter=200)
{
# ### Outlier type 1 =======================
set.seed(seed)
n_rate = length(rate)
print("outliertype 1:")
data_1c_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1c_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1r_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1r_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1l_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1l_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1u_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1u_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1c_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1c_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1r_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1r_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1l_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1l_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1u_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1u_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1c_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1c_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1r_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1r_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1l_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1l_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_1u_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_1u_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
for(r in 1:length(rate))
{
hh = list()
pb <- progress_bar$new(
format = '[:bar] :percent eta: :eta',
total = niter, clear = FALSE, width = 80
)
for(t in 1:niter)
{
pb$tick()
data = data.frame(data_generation_outlier1(n, a, b, c, d, e, f, g, h, i, j, seed=t, outlierType="central and range", alpha=rate[r]))
# print(head(data))
hh[[t]] = comparasion(cbind(yl,yu)~xl+xu, data[,5:8])
}
hhh = myprocess(hh)
data_1c_m[r,] = hhh[[1]][1,]
data_1r_m[r,] = hhh[[1]][2,]
data_1l_m[r,] = hhh[[1]][3,]
data_1u_m[r,] = hhh[[1]][4,]
data_1c_l[r,] = hhh[[2]][1,]
data_1r_l[r,] = hhh[[2]][2,]
data_1l_l[r,] = hhh[[2]][3,]
data_1u_l[r,] = hhh[[2]][4,]
data_1c_u[r,] = hhh[[3]][1,]
data_1r_u[r,] = hhh[[3]][2,]
data_1l_u[r,] = hhh[[3]][3,]
data_1u_u[r,] = hhh[[3]][4,]
}
write.csv(data_1c_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1c_m.csv", row.names = FALSE)
write.csv(data_1r_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1r_m.csv", row.names = FALSE)
write.csv(data_1l_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1l_m.csv", row.names = FALSE)
write.csv(data_1u_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1u_m.csv", row.names = FALSE)
write.csv(data_1c_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1c_l.csv", row.names = FALSE)
write.csv(data_1r_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1r_l.csv", row.names = FALSE)
write.csv(data_1l_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1l_l.csv", row.names = FALSE)
write.csv(data_1u_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1u_l.csv", row.names = FALSE)
write.csv(data_1c_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1c_u.csv", row.names = FALSE)
write.csv(data_1r_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1r_u.csv", row.names = FALSE)
write.csv(data_1l_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1l_u.csv", row.names = FALSE)
write.csv(data_1u_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_1u_u.csv", row.names = FALSE)
### Outlier type 2 ===================
print("outliertype 2:")
data_2c_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2c_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2r_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2r_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2l_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2l_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2u_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2u_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2c_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2c_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2r_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2r_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2l_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2l_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2u_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2u_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2c_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2c_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2r_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2r_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2l_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2l_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_2u_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_2u_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
for(r in 1:length(rate))
{
hh = list()
pb <- progress_bar$new(
format = '[:bar] :percent eta: :eta',
total = niter, clear = FALSE, width = 80
)
for(t in 1:niter)
{
pb$tick()
data = data.frame(data_generation_outlier2(n, a, b, c, d, e, f, g, h, i, j, seed=t, outlierType="central and range", alpha=rate[r]))
hh[[t]] = comparasion(cbind(yl,yu)~xl+xu, data[,5:8])
}
hhh = myprocess(hh)
data_2c_m[r,] = hhh[[1]][1,]
data_2r_m[r,] = hhh[[1]][2,]
data_2l_m[r,] = hhh[[1]][3,]
data_2u_m[r,] = hhh[[1]][4,]
data_2c_l[r,] = hhh[[2]][1,]
data_2r_l[r,] = hhh[[2]][2,]
data_2l_l[r,] = hhh[[2]][3,]
data_2u_l[r,] = hhh[[2]][4,]
data_2c_u[r,] = hhh[[3]][1,]
data_2r_u[r,] = hhh[[3]][2,]
data_2l_u[r,] = hhh[[3]][3,]
data_2u_u[r,] = hhh[[3]][4,]
}
write.csv(data_2c_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2c_m.csv", row.names = FALSE)
write.csv(data_2r_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2r_m.csv", row.names = FALSE)
write.csv(data_2l_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2l_m.csv", row.names = FALSE)
write.csv(data_2u_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2u_m.csv", row.names = FALSE)
write.csv(data_2c_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2c_l.csv", row.names = FALSE)
write.csv(data_2r_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2r_l.csv", row.names = FALSE)
write.csv(data_2l_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2l_l.csv", row.names = FALSE)
write.csv(data_2u_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2u_l.csv", row.names = FALSE)
write.csv(data_2c_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2c_u.csv", row.names = FALSE)
write.csv(data_2r_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2r_u.csv", row.names = FALSE)
write.csv(data_2l_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2l_u.csv", row.names = FALSE)
write.csv(data_2u_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_2u_u.csv", row.names = FALSE)
### Outlier type 3 =======================
print("outliertype 3:")
data_3c_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3c_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3r_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3r_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3l_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3l_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3u_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3u_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3c_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3c_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3r_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3r_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3l_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3l_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3u_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3u_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3c_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3c_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3r_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3r_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3l_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3l_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_3u_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_3u_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
for(r in 1:length(rate))
{
hh = list()
pb <- progress_bar$new(
format = '[:bar] :percent eta: :eta',
total = niter, clear = FALSE, width = 80
)
for(t in 1:niter)
{
pb$tick()
data = data.frame(data_generation_outlier3(n, a, b, c, d, e, f, g, h, i, j, seed=t, outlierType="central", alpha=rate[r]))
hh[[t]] = comparasion(cbind(yl,yu)~xl+xu, data[,5:8])
}
hhh = myprocess(hh)
data_3c_m[r,] = hhh[[1]][1,]
data_3r_m[r,] = hhh[[1]][2,]
data_3l_m[r,] = hhh[[1]][3,]
data_3u_m[r,] = hhh[[1]][4,]
data_3c_l[r,] = hhh[[2]][1,]
data_3r_l[r,] = hhh[[2]][2,]
data_3l_l[r,] = hhh[[2]][3,]
data_3u_l[r,] = hhh[[2]][4,]
data_3c_u[r,] = hhh[[3]][1,]
data_3r_u[r,] = hhh[[3]][2,]
data_3l_u[r,] = hhh[[3]][3,]
data_3u_u[r,] = hhh[[3]][4,]
}
write.csv(data_3c_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3c_m.csv", row.names = FALSE)
write.csv(data_3r_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3r_m.csv", row.names = FALSE)
write.csv(data_3l_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3l_m.csv", row.names = FALSE)
write.csv(data_3u_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3u_m.csv", row.names = FALSE)
write.csv(data_3c_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3c_l.csv", row.names = FALSE)
write.csv(data_3r_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3r_l.csv", row.names = FALSE)
write.csv(data_3l_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3l_l.csv", row.names = FALSE)
write.csv(data_3u_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3u_l.csv", row.names = FALSE)
write.csv(data_3c_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3c_u.csv", row.names = FALSE)
write.csv(data_3r_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3r_u.csv", row.names = FALSE)
write.csv(data_3l_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3l_u.csv", row.names = FALSE)
write.csv(data_3u_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_3u_u.csv", row.names = FALSE)
### Outlier type 4 ==========================
print("outliertype 4:")
data_4c_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4c_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4r_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4r_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4l_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4l_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4u_m = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4u_m) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4c_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4c_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4r_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4r_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4l_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4l_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4u_l = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4u_l) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4c_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4c_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4r_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4r_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4l_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4l_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
data_4u_u = as.data.frame(matrix(nrow=n_rate,ncol=12))
names(data_4u_u) = c("CM", "CRM", "CCRM", "IRR", "FUZZY", "SSLR", "LN_IRR", "DK","HD1","HD_normal", "HD_sum","HD_modified")
for(r in 1:length(rate))
{
hh = list()
pb <- progress_bar$new(
format = '[:bar] :percent eta: :eta',
total = niter, clear = FALSE, width = 80
)
for(t in 1:niter)
{
pb$tick()
data = data.frame(data_generation_outlier4(n, a, b, c, d, e, f, g, h, i, j, seed=t, outlierType="central and range", alpha=rate[r]))
hh[[t]] = comparasion(cbind(yl,yu)~xl+xu, data[,5:8])
}
hhh = myprocess(hh)
data_4c_m[r,] = hhh[[1]][1,]
data_4r_m[r,] = hhh[[1]][2,]
data_4l_m[r,] = hhh[[1]][3,]
data_4u_m[r,] = hhh[[1]][4,]
data_4c_l[r,] = hhh[[2]][1,]
data_4r_l[r,] = hhh[[2]][2,]
data_4l_l[r,] = hhh[[2]][3,]
data_4u_l[r,] = hhh[[2]][4,]
data_4c_u[r,] = hhh[[3]][1,]
data_4r_u[r,] = hhh[[3]][2,]
data_4l_u[r,] = hhh[[3]][3,]
data_4u_u[r,] = hhh[[3]][4,]
}
write.csv(data_4c_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4c_m.csv", row.names = FALSE)
write.csv(data_4r_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4r_m.csv", row.names = FALSE)
write.csv(data_4l_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4l_m.csv", row.names = FALSE)
write.csv(data_4u_m,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4u_m.csv", row.names = FALSE)
write.csv(data_4c_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4c_l.csv", row.names = FALSE)
write.csv(data_4r_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4r_l.csv", row.names = FALSE)
write.csv(data_4l_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4l_l.csv", row.names = FALSE)
write.csv(data_4u_l,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4u_l.csv", row.names = FALSE)
write.csv(data_4c_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4c_u.csv", row.names = FALSE)
write.csv(data_4r_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4r_u.csv", row.names = FALSE)
write.csv(data_4l_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4l_u.csv", row.names = FALSE)
write.csv(data_4u_u,"C:\\Users\\kangxinlai\\Desktop\\zero-kp\\ZKRP\\R\\plotdata\\data_4u_u.csv", row.names = FALSE)
}
simu_plotdata_save(rate = seq(0.01,0.25,0.04), n=500, 0, 20, 0, 1, 0, 10, 0.2, 0.5, 0, 5, seed = 0, niter = 500)
?optim
library(progress)
library(mgcv)
library(caret)
library(MAINT.Data)
library(iRegression)
library(MASS)
library(quantreg)
library(Rdonlp2)
library(sm)
library(Matrix)
source('IntervalPlot.R')
source('DataGeneration.R')
source("regression.R")
outlier_comparasion_simu(cbind(yl,yu)~xl+xu, n=200, 0, 20, 0, 2, 0, 5, 0.2, 0.5, 0, 5,-10,-5, seed=0, outlierType = 1)
outlier_comparasion_simu(cbind(yl,yu)~xl+xu, n=200, 0, 20, 0, 2, 0, 5, 0.2, 0.5, 0, 5,-10,-5, seed=0, outlierType = 2)
outlier_comparasion_simu(cbind(yl,yu)~xl+xu, n=200, 0, 20, 0, 2, 0, 5, 0.2, 0.5, 0, 5,-10,-5, seed=0, outlierType = 3)
outlier_comparasion_simu(cbind(yl,yu)~xl+xu, n=200, 0, 20, 0, 2, 0, 5, 0.2, 0.5, 0, 5,-10,-5, seed=0, outlierType = 4)
outlier_comparasion_simu(cbind(yl,yu)~xl+xu, n=200, 0, 20, 0, 2, 0, 5, 0.2, 0.5, 0, 5,-10,-5, seed=0, outlierType = 1)
outlier_comparasion_simu(cbind(yl,yu)~xl+xu, n=200, 0, 20, 0, 2, 0, 5, 0.2, 0.5, 0, 5,-10,-5, seed=0, outlierType = 2)
